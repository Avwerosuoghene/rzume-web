<div class="add_job_container">
  <div class="title_elements">
    <h3 class="light_text">Add Job Application</h3>

    <button mat-icon-button (click)="cancelApplication()">
      <mat-icon>close</mat-icon>
    </button>
  </div>

  <form
    [formGroup]="applicationFormGroup"
    (ngSubmit)="addApplication()"
    id="add_job_form"
  >
    <div class="form-input-container">
      <div class="form-field">
        <label for="companyName">Company</label>
        <div class="input-wrapper">
          <input
            id="companyName"
            class="form-input"
            [class.error]="getFieldError('companyName')"
            placeholder="Enter company name"
            type="text"
            formControlName="companyName"
            name="companyName"
            appFloatingLabel
          />
        </div>
        <span *ngIf="getFieldError('companyName')" class="error-message">
          {{ getFieldError('companyName') }}
        </span>
      </div>

      <div class="form-field">
        <label for="position">Job Role</label>
        <div class="input-wrapper">
          <input
            id="position"
            class="form-input"
            [class.error]="getFieldError('position')"
            placeholder="Enter job role"
            type="text"
            formControlName="position"
            name="position"
            appFloatingLabel
          />
        </div>
        <span *ngIf="getFieldError('position')" class="error-message">
          {{ getFieldError('position') }}
        </span>
      </div>

      <div class="form-field select-field">
        <label for="resumeId">CV Used</label>
        <div class="input-wrapper">
          <select
            id="resumeId"
            class="form-input form-select"
            formControlName="resumeId"
            appFloatingLabel>
            @if (!hasResumes) {
              <option disabled>{{ noResumesMessage }}</option>
            }
            @for (resume of resumes; track resume.id) {
              <option [value]="resume.id">{{ resume.fileName }}</option>
            }
          </select>
        </div>
      </div>

      <div class="form-field">
        <label for="jobLink">Job URL</label>
        <div class="input-wrapper">
          <input
            id="jobLink"
            class="form-input"
            placeholder="Enter link to job"
            type="url"
            formControlName="jobLink"
            name="jobLink"
            appFloatingLabel
          />
        </div>
      </div>

      <div class="application-status_date-container">
        <div class="form-field date-field">
          <label for="applicationDate">Date</label>
          <div class="input-wrapper">
            <input
              id="applicationDate"
              class="form-input"
              [matDatepicker]="picker"
              formControlName="applicationDate"
              [max]="maxDate"
              placeholder="Select date"
              readonly
              appFloatingLabel
            />
            <mat-datepicker-toggle matIconSuffix [for]="picker" class="date-toggle">
            </mat-datepicker-toggle>
            <mat-datepicker #picker></mat-datepicker>
          </div>
        </div>

        <div class="form-field select-field">
          <label for="status">Application Status</label>
          <div class="input-wrapper">
            <select
              id="status"
              class="form-input form-select"
              formControlName="status"
              appFloatingLabel>
              @for (statusOption of applicationStatusOptions; track statusOption.value) {
                <option [value]="statusOption.value">{{ statusOption.name }}</option>
              }
            </select>
          </div>
        </div>
      </div>

      <button
        id="add_job_btn"
        mat-flat-button
        [disabled]="isBtnDisabled()"
        type="submit"
      >
        <div class="button-elements">
          @if (loaderIsActive) {
          <app-circular-loader></app-circular-loader>
          }

          <p>{{ editMode ? "Update" : "Add" + " Job Application" }}</p>
        </div>
      </button>
    </div>
  </form>
</div>
