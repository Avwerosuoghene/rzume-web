<div class="profile-view">
  <app-profile-photo-upload
    [photoUrl]="profilePhotoUrl"
    [isLoading]="isPhotoUploading"
    (photoSelected)="onPhotoSelected($event)"
  ></app-profile-photo-upload>

  <hr class="section-divider" />

  <div class="personal-info-section">
    <div class="left-section">
      <h4>{{ labels.PERSONAL_INFO }}</h4>
      <p class="light_text">{{ labels.PERSONAL_INFO_DESCRIPTION }}</p>

      <div class="form-actions desktop">
        <ng-container *ngTemplateOutlet="saveButton"></ng-container>
      </div>
    </div>

    <div class="right-section">
      <form
        [formGroup]="profileForm"
        (ngSubmit)="onSubmit()"
        class="profile-form"
      >

      <div class="form-fields-container"> 
        <div class="form-field">
          <label for="firstName">
            {{ labels.FIRST_NAME }}</label>
          <input
            id="firstName"
            type="text"
            formControlName="firstName"
            class="form-input"
            [class.error]="getFieldError('firstName')"
          />
          <span *ngIf="getFieldError('firstName')" class="error-message">
            {{ getFieldError("firstName") }}
          </span>
        </div>

        <div class="form-field">
          <label for="lastName">{{ labels.LAST_NAME }}</label>
          <input
            id="lastName"
            type="text"
            formControlName="lastName"
            class="form-input"
            [class.error]="getFieldError('lastName')"
          />
          <span *ngIf="getFieldError('lastName')" class="error-message">
            {{ getFieldError("lastName") }}
          </span>
        </div>
      </div>
       
      <div class="form-fields-container">
        <div class="form-field">
          <label for="userName">{{ labels.USER_NAME }}</label>
          <input
            id="userName"
            type="text"
            formControlName="userName"
            class="form-input"
            [class.error]="getFieldError('userName')"
          />
          <span *ngIf="getFieldError('userName')" class="error-message">
            {{ getFieldError("userName") }}
          </span>
        </div>

        <div class="form-field">
          <label for="email">{{ labels.EMAIL_ADDRESS }}</label>
          <input
            id="email"
            type="email"
            formControlName="email"
            class="form-input"
            readonly
          />
        </div>
      </div>

        <div class="form-actions mobile">
          <ng-container *ngTemplateOutlet="saveButton"></ng-container>
        </div>
      </form>
    </div>
  </div>

  <ng-template #saveButton>
    <button
      type="submit"
      mat-flat-button
      id="save-btn"
      [disabled]="isLoading || !isFormDirty"
      (click)="onSubmit()"
    >
      <span *ngIf="!isLoading">{{ labels.SAVE_CHANGES }}</span>
      <span *ngIf="isLoading" class="loading-text">Saving...</span>
    </button>
  </ng-template>
</div>
