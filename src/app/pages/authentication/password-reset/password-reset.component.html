<div class="password-reset-container">
  <!-- Success / Failure Icon -->
  <ng-container *ngIf="activePasswordResetScreen === PassWordResetScreens.successScreen">
    <div
      class="completed_request_icon"
      [ngClass]="passwordResetCompleteIcon === IconStat.success ? 'success' : 'failed'"
    >
      <mat-icon>{{ passwordResetCompleteIcon }}</mat-icon>
    </div>
  </ng-container>

  <!-- Header -->
  <div class="auth-top_view_elements">
    <h3 *ngIf="activePasswordResetScreen === PassWordResetScreens.formScreen; else successHeader">
      Reset Password
    </h3>
    <ng-template #successHeader>
      <h3>Password Changed</h3>
      <p id="reset-complete-msg">{{ resetCompleteMessage }}</p>
    </ng-template>
  </div>

  <!-- Password Reset Form -->
  <form
    *ngIf="activePasswordResetScreen === PassWordResetScreens.formScreen"
    [formGroup]="resetPassFormGroup"
    (ngSubmit)="submitPasswordResetForm()"
  >
    <div class="form-input-container">
      <!-- Password Field -->
      <mat-form-field appearance="outline">
        <mat-label>Password</mat-label>
        <input
          matInput
          placeholder="Enter your password"
          [type]="passwordVisibility"
          formControlName="password"
          (keyup)="validatePassword()"
        />
        <mat-icon
          matSuffix
          (click)="togglePasswordVisibility(ToggledPassword.passwordVisibility)"
        >
          {{
            passwordVisibility === PasswordVisibility.password ? "visibility_off" : "visibility"
          }}
        </mat-icon>
        <mat-error *ngIf="password?.hasError('required')"
          >Password required</mat-error
        >
      </mat-form-field>

      <!-- Password Strength Checker -->
      <div id="reset_pass_strength">
        <app-password-strength-checker></app-password-strength-checker>
      </div>

      <!-- Confirm Password Field -->
      <mat-form-field appearance="outline">
        <mat-label>Confirm Password</mat-label>
        <input
          matInput
          placeholder="Confirm your password"
          [type]="confirmPasswordVisibility"
          formControlName="confirmPassword"
        />
        <mat-icon
          matSuffix
          (click)="togglePasswordVisibility(ToggledPassword.confirmPasswordVisibility)"
        >
          {{
            confirmPasswordVisibility === PasswordVisibility.password
              ? "visibility_off"
              : "visibility"
          }}
        </mat-icon>
        <mat-error *ngIf="confirmPassword?.hasError('required')"
          >Please re-enter your password</mat-error
        >
        <mat-error
          *ngIf="
            confirmPassword?.invalid && !confirmPassword?.hasError('required')
          "
          >Passwords do not match</mat-error
        >
      </mat-form-field>

      <!-- Submit Button -->
      <button
        mat-flat-button
        class="form-input-confirm-button"
        [disabled]="isBtnDisabled()"
        type="submit"
        id="resetPassBtn"
      >
        <div class="button-elements">
          <app-circular-loader *ngIf="loaderIsActive"></app-circular-loader>
          <p>Reset Password</p>
        </div>
      </button>
    </div>
  </form>

  <!-- Success / Retry Buttons -->
  <ng-container *ngIf="activePasswordResetScreen === PassWordResetScreens.successScreen">
    <div class="succes_screen_btns">
      <button
        mat-flat-button
        class="reset_action_btn back_to_login"
        type="button"
        (click)="goToLogin()"
      >
        Back to Login
      </button>

      <button
        *ngIf="passwordResetCompleteIcon === 'close'"
        mat-stroked-button
        class="reset_action_btn retry_btn"
        type="button"
        (click)="goBackToForm()"
      >
        Retry Reset
      </button>
    </div>
  </ng-container>
</div>
